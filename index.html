<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø²ÙŠØªÙƒ | Ù…Ø­Ø§ÙƒÙŠ + ÙƒØªØ§Ù„ÙˆØ¬ Ø°ÙƒÙŠ</title>

<style>
body{font-family:Tahoma,Arial;background:#f2f2f2;padding:20px}
.container{background:#fff;padding:20px;border-radius:10px;max-width:560px;margin:auto}
h2{text-align:center}
select,button{width:100%;padding:12px;margin-top:10px;font-size:16px}
button{cursor:pointer;border:none}
.primary{background:#0a7cff;color:#fff}
.secondary{background:#444;color:#fff}
.whatsapp{background:#25D366;color:#fff}
.product{background:#f9f9f9;padding:12px;margin-top:10px;border-radius:6px}
.price{color:#0a7cff;font-weight:bold;margin-top:5px}
.footer{text-align:center;font-size:13px;color:#666;margin-top:20px}
</style>
</head>

<body>

<div class="container">
<h2>ğŸ”§ Ø²ÙŠØªÙƒ â€“ Ø§Ù„Ù…Ø­Ø§ÙƒÙŠ Ø§Ù„Ø°ÙƒÙŠ</h2>

<!-- Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
<select id="clientType">
  <option value="individual">ÙØ±Ø¯</option>
  <option value="workshop">ÙˆØ±Ø´Ø©</option>
  <option value="distributor">Ù…ÙˆØ²Ø¹</option>
</select>

<!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© -->
<select id="carBrand">
  <option value="">Ù…Ø§Ø±ÙƒØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</option>
  <option>Toyota</option><option>Mitsubishi</option><option>Hyundai</option>
  <option>Nissan</option><option>Chevrolet</option><option>Kia</option>
  <option>Peugeot</option><option>Renault</option>
</select>

<select id="engineType">
  <option value="">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­Ø±Ùƒ</option>
  <option value="Ø¨Ù†Ø²ÙŠÙ†">Ø¨Ù†Ø²ÙŠÙ†</option>
  <option value="Ø¯ÙŠØ²Ù„">Ø¯ÙŠØ²Ù„</option>
</select>

<!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù‚Ø±Ø§Ø± -->
<button class="primary" onclick="recommendOil()">Ø§Ø¹Ø±Ù Ø§Ù„Ø²ÙŠØª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</button>
<button class="secondary" onclick="compareOils()">Ù‚Ø§Ø±Ù† Ø§Ù„Ø²ÙŠÙˆØª</button>

<!-- Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ -->
<select id="categorySelect" onchange="loadCategory()">
  <option value="">ØªØµÙØ­ Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</option>
</select>

<div id="result"></div>

<div class="footer">Ø²ÙŠØªÙƒ â€“ Smart Oil System</div>
</div>

<script>
/* ========= SETTINGS ========= */
const WHATSAPP="201019388501";

/* ========= PRICING ========= */
function priceRate(){
  const t=document.getElementById("clientType").value;
  if(t==="distributor") return 1.05;
  if(t==="workshop") return 1.15;
  return 1.25;
}

/* ========= DATA ========= */
let data=null;
fetch("oil_shop_complete.json")
.then(r=>r.json())
.then(d=>{data=d;loadCategories();});

/* ========= CATEGORIES ========= */
function loadCategories(){
  const s=document.getElementById("categorySelect");
  data.categories.forEach(c=>{
    const o=document.createElement("option");
    o.value=c.id;o.textContent=c.name;
    s.appendChild(o);
  });
}

/* ========= RECOMMEND ========= */
function recommendOil(){
  const box=document.getElementById("result");
  box.innerHTML="";
  const oils=data.products.filter(p=>p.category_id===1).slice(0,3);

  oils.forEach(p=>{
    const price=Math.round(p.wholesale_price*priceRate());
    box.innerHTML+=card(p,price);
  });
}

/* ========= COMPARE ========= */
function compareOils(){
  const box=document.getElementById("result");
  box.innerHTML="";
  const oils=data.products.filter(p=>p.category_id===1).slice(0,5);

  oils.forEach(p=>{
    const price=Math.round(p.wholesale_price*priceRate());
    box.innerHTML+=card(p,price);
  });
}

/* ========= CATEGORY VIEW ========= */
function loadCategory(){
  const id=Number(document.getElementById("categorySelect").value);
  const box=document.getElementById("result");
  box.innerHTML="";
  if(!id) return;

  data.products.filter(p=>p.category_id===id).forEach(p=>{
    const price=Math.round(p.wholesale_price*priceRate());
    box.innerHTML+=card(p,price);
  });
}

/* ========= CARD ========= */
function card(p,price){
  return `
  <div class="product">
    <strong>${p.product_name}</strong><br>
    ${p.liters?`Ø§Ù„Ø³Ø¹Ø©: ${p.liters} ${p.unit}<br>`:""}
    <div class="price">Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡</div>
    <button class="whatsapp"
      onclick="wa('${p.product_name}',${price})">
      Ø§Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨
    </button>
  </div>`;
}

/* ========= WHATSAPP ========= */
function wa(name,price){
  const msg=`Ø·Ù„Ø¨ Ù…Ù† Ø²ÙŠØªÙƒ:
${name}
Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡`;
  window.open(`https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}`);
}
</script>

</body>
</html>
