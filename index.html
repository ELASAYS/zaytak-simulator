<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø²ÙŠØªÙƒ | ÙƒØªØ§Ù„ÙˆØ¬ Ø²ÙŠÙˆØª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</title>

<style>
body {
  font-family: Tahoma, Arial;
  background: #f2f2f2;
  padding: 20px;
}
.container {
  background: #ffffff;
  padding: 20px;
  border-radius: 10px;
  max-width: 480px;
  margin: auto;
}
h2 {
  text-align: center;
}
select {
  width: 100%;
  padding: 12px;
  margin-top: 10px;
  font-size: 16px;
}
.product {
  background: #f9f9f9;
  padding: 12px;
  margin-top: 10px;
  border-radius: 6px;
}
.price {
  color: #0a7cff;
  font-weight: bold;
  margin-top: 5px;
}
.footer {
  margin-top: 20px;
  text-align: center;
  font-size: 13px;
  color: #666;
}
</style>
</head>

<body>

<div class="container">
  <h2>ğŸ›’ ÙƒØªØ§Ù„ÙˆØ¬ Ø²ÙŠØªÙƒ</h2>

  <select id="categorySelect" onchange="loadProducts()">
    <option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ</option>
  </select>

  <div id="productsList"></div>

  <div class="footer">
    Ø²ÙŠØªÙƒ â€“ Smart Oil Catalog
  </div>
</div>

<script>
/* =========================
   SETTINGS
========================= */
const PROFIT_RATE = 1.25; // Ù†Ø³Ø¨Ø© Ø§Ù„Ø±Ø¨Ø­

/* =========================
   DATA LOAD
========================= */
let shopData = null;

fetch("oil_shop_complete.json")
  .then(res => res.json())
  .then(data => {
    shopData = data;
    loadCategories();
  })
  .catch(() => {
    alert("ÙØ´Ù„ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª");
  });

/* =========================
   LOAD CATEGORIES
========================= */
function loadCategories() {
  const select = document.getElementById("categorySelect");
  shopData.categories.forEach(cat => {
    const opt = document.createElement("option");
    opt.value = cat.id;
    opt.textContent = cat.name;
    select.appendChild(opt);
  });
}

/* =========================
   LOAD PRODUCTS
========================= */
function loadProducts() {
  const catId = Number(document.getElementById("categorySelect").value);
  const box = document.getElementById("productsList");
  box.innerHTML = "";

  if (!catId) return;

  const products = shopData.products.filter(
    p => p.category_id === catId
  );

  if (products.length === 0) {
    box.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ</p>";
    return;
  }

  products.forEach(p => {
    const sellPrice = Math.round(p.wholesale_price * PROFIT_RATE);

    box.innerHTML += `
      <div class="product">
        <strong>${p.product_name}</strong><br>
        ${p.liters ? "Ø§Ù„Ø³Ø¹Ø©: " + p.liters + " " + p.unit + "<br>" : ""}
        <div class="price">Ø§Ù„Ø³Ø¹Ø±: ${sellPrice} Ø¬Ù†ÙŠÙ‡</div>
      </div>
    `;
  });
}
</script>

</body>
</html>
