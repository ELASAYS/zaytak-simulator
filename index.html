<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø²ÙŠØªÙƒ | Ù…Ù†ØµØ© Ø¨ÙŠØ¹ Ø²ÙŠÙˆØª Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª</title>

<style>
body{font-family:Tahoma,Arial;background:#f2f2f2;padding:20px}
.container{background:#fff;padding:20px;border-radius:10px;max-width:620px;margin:auto}
h2{text-align:center}
p{text-align:center;color:#555}
select,button{width:100%;padding:12px;margin-top:10px;font-size:16px}
button{border:none;cursor:pointer}
.primary{background:#0a7cff;color:#fff}
.secondary{background:#444;color:#fff}
.whatsapp{background:#25D366;color:#fff}
.product{background:#f9f9f9;padding:12px;margin-top:10px;border-radius:6px}
.price{color:#0a7cff;font-weight:bold;margin-top:5px}
.footer{text-align:center;font-size:13px;color:#666;margin-top:20px}
.hidden{display:none}
</style>
</head>

<body>

<!-- ================= INTRO ================= -->
<div class="container" id="intro">
  <h2>ğŸ”§ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ø²ÙŠØªÙƒ</h2>
  <p>Ø§Ø®ØªØ§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø© Ù„ÙŠÙƒ</p>

  <button class="primary" onclick="startIndividual()">ğŸš— Ø£Ù†Ø§ ØµØ§Ø­Ø¨ Ø¹Ø±Ø¨ÙŠØ©</button>
  <button class="secondary" onclick="startWorkshop()">ğŸª ÙˆØ±Ø´Ø© / Ù…ÙˆØ²Ù‘Ø¹</button>
</div>

<!-- ================= MAIN APP ================= -->
<div class="container hidden" id="mainApp">

<h2 id="title">ğŸ”§ Ø²ÙŠØªÙƒ â€“ Ø§Ø®ØªØ§Ø± Ø§Ù„ØµØ­</h2>

<!-- Ù†ÙˆØ¹ Ø§Ù„Ø¹Ù…ÙŠÙ„ -->
<select id="clientType">
  <option value="individual">ÙØ±Ø¯</option>
  <option value="workshop">ÙˆØ±Ø´Ø©</option>
  <option value="distributor">Ù…ÙˆØ²Ù‘Ø¹</option>
</select>

<!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© (Ù„Ù„ÙØ±Ø¯ ÙˆØ§Ù„ÙˆØ±Ø´Ø© ÙÙ‚Ø·) -->
<select id="carBrand">
  <option value="">Ù…Ø§Ø±ÙƒØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø©</option>
  <option>Toyota</option><option>Mitsubishi</option><option>Hyundai</option>
  <option>Nissan</option><option>Chevrolet</option><option>Kia</option>
  <option>Peugeot</option><option>Renault</option>
</select>

<select id="engineType">
  <option value="">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø­Ø±Ùƒ</option>
  <option value="Ø¨Ù†Ø²ÙŠÙ†">Ø¨Ù†Ø²ÙŠÙ†</option>
  <option value="Ø¯ÙŠØ²Ù„">Ø¯ÙŠØ²Ù„</option>
</select>

<!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù‚Ø±Ø§Ø± -->
<button class="primary" onclick="recommendOil()">Ø§Ø¹Ø±Ù Ø§Ù„Ø²ÙŠØª Ø§Ù„Ù…Ù†Ø§Ø³Ø¨</button>
<button class="secondary" onclick="compareOils()">Ù‚Ø§Ø±Ù† Ø§Ù„Ø²ÙŠÙˆØª</button>

<!-- Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ -->
<select id="categorySelect" onchange="loadCategory()">
  <option value="">ØªØµÙØ­ Ø­Ø³Ø¨ Ø§Ù„ØªØµÙ†ÙŠÙ</option>
</select>

<div id="result"></div>

<div class="footer">Ø²ÙŠØªÙƒ â€“ Smart Oil Sales System</div>
</div>

<script>
/* ================= SETTINGS ================= */
const WHATSAPP="201019388501";

/* ================= MODE ================= */
let MODE="individual";

/* ================= PRICING ================= */
function priceRate(){
  const t=document.getElementById("clientType").value;
  if(t==="distributor") return 1.05;
  if(t==="workshop") return 1.15;
  return 1.25;
}

/* ================= DATA ================= */
let data=null;
fetch("oil_shop_complete.json")
.then(r=>r.json())
.then(d=>{data=d;loadCategories();});

/* ================= START ================= */
function startIndividual(){
  document.getElementById("intro").classList.add("hidden");
  document.getElementById("mainApp").classList.remove("hidden");
  MODE="individual";
}

function startWorkshop(){
  document.getElementById("intro").classList.add("hidden");
  document.getElementById("mainApp").classList.remove("hidden");
  MODE="workshop";
}

/* ================= CLIENT TYPE CHANGE ================= */
document.getElementById("clientType").addEventListener("change",()=>{
  const type=document.getElementById("clientType").value;
  const car=document.getElementById("carBrand");
  const engine=document.getElementById("engineType");

  if(type==="distributor"){
    car.classList.add("hidden");
    engine.classList.add("hidden");
    unlockProMode();
    document.getElementById("title").innerText="ğŸ“¦ ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…ÙˆØ²Ù‘Ø¹ â€“ Ø§Ø·Ù„Ø¨ Ø¨Ø³Ù‡ÙˆÙ„Ø©";
  }else{
    car.classList.remove("hidden");
    engine.classList.remove("hidden");
    document.getElementById("title").innerText="ğŸ”§ Ø²ÙŠØªÙƒ â€“ Ø§Ø®ØªØ§Ø± Ø§Ù„ØµØ­";
  }
});

/* ================= PRO MODE ================= */
function unlockProMode(){
  document.getElementById("categorySelect").classList.remove("hidden");
}

/* ================= CATEGORIES ================= */
function loadCategories(){
  const s=document.getElementById("categorySelect");
  data.categories.forEach(c=>{
    const o=document.createElement("option");
    o.value=c.id;o.textContent=c.name;
    s.appendChild(o);
  });
  s.classList.add("hidden");
}

/* ================= RECOMMEND (ÙØ±Ø¯) ================= */
function recommendOil(){
  const box=document.getElementById("result");
  box.innerHTML="";

  const type=document.getElementById("clientType").value;
  if(type==="distributor"){
    box.innerHTML="Ø§Ø®ØªØ± ØªØµÙ†ÙŠÙ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª.";
    return;
  }

  const engine=document.getElementById("engineType").value||"Ø¨Ù†Ø²ÙŠÙ†";

  const oils=data.products.filter(p =>
    p.category_id===1 &&
    (engine==="Ø¯ÙŠØ²Ù„"
      ? p.product_name.includes("15")||p.product_name.includes("20")
      : p.product_name.includes("10")||p.product_name.includes("5"))
  );

  if(oils.length===0){
    box.innerHTML="Ø£ÙŠ Ø²ÙŠØª Ù…ÙˆØ«ÙˆÙ‚ Ù…Ù†Ø§Ø³Ø¨ Ù„Ø¹Ø±Ø¨ÙŠØªÙƒØŒ Ø§Ø·Ù„Ø¨ ÙˆØ³Ù†Ø³Ø§Ø¹Ø¯Ùƒ.";
    return;
  }

  oils.sort((a,b)=>a.wholesale_price-b.wholesale_price);
  const chosen=oils[0];
  const price=Math.round(chosen.wholesale_price*priceRate());

  box.innerHTML=`
    <div class="product">
      <strong>Ø§Ù„Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø¢Ù…Ù† Ù„Ø¹Ø±Ø¨ÙŠØªÙƒ</s
