<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø²ÙŠØªÙƒ | ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…ÙˆØ²Ù‘Ø¹</title>

<style>
body{
  font-family:Tahoma,Arial;
  background:#f2f2f2;
  padding:15px
}
.container{
  background:#fff;
  padding:20px;
  border-radius:10px;
  max-width:650px;
  margin:auto
}
h2{text-align:center}
select,button{
  width:100%;
  padding:12px;
  margin-top:10px;
  font-size:16px
}
button{
  border:none;
  cursor:pointer
}
.product{
  background:#f9f9f9;
  padding:12px;
  margin-top:10px;
  border-radius:6px
}
.price{
  color:#0a7cff;
  font-weight:bold;
  margin-top:5px
}
.whatsapp{
  background:#25D366;
  color:#fff;
  margin-top:8px
}
.footer{
  text-align:center;
  font-size:13px;
  color:#666;
  margin-top:20px
}
</style>
</head>

<body>

<div class="container">
  <h2>ğŸ“¦ ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„Ù…ÙˆØ²Ù‘Ø¹</h2>

  <select id="categorySelect">
    <option value="">Ø§Ø®ØªØ± Ø§Ù„ØªØµÙ†ÙŠÙ</option>
  </select>

  <div id="products"></div>

  <div class="footer">
    Ø²ÙŠØªÙƒ â€“ Distributor Sales Catalog
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function(){

const WHATSAPP = "201019388501"; // Ø±Ù‚Ù…Ùƒ Ø¨Ø¯ÙˆÙ† +
let data = null;

/* ===== LOAD DATA ===== */
fetch("oil_shop_complete.json")
  .then(res => res.json())
  .then(json => {
    data = json;
    loadCategories();
  });

/* ===== LOAD CATEGORIES ===== */
function loadCategories(){
  const select = document.getElementById("categorySelect");
  data.categories.forEach(cat=>{
    const opt = document.createElement("option");
    opt.value = cat.id;
    opt.textContent = cat.name;
    select.appendChild(opt);
  });
}

/* ===== CATEGORY CHANGE ===== */
document.getElementById("categorySelect").onchange = function(){
  const catId = Number(this.value);
  const box = document.getElementById("products");
  box.innerHTML = "";

  if(!catId) return;

  const items = data.products.filter(p => p.category_id === catId);

  if(items.length === 0){
    box.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ØªØµÙ†ÙŠÙ</p>";
    return;
  }

  items.forEach(p=>{
    const price = Math.round(p.wholesale_price); // Ø³Ø¹Ø± ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·

    box.innerHTML += `
      <div class="product">
        <strong>${p.product_name}</strong><br>
        ${p.liters ? `Ø§Ù„Ø³Ø¹Ø©: ${p.liters} ${p.unit}<br>` : ""}
        <div class="price">Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡</div>
        <button class="whatsapp"
          onclick="sendWA('${p.product_name}', ${price})">
          Ø§Ø·Ù„Ø¨ ÙˆØ§ØªØ³Ø§Ø¨
        </button>
      </div>
    `;
  });
};

/* ===== WHATSAPP ===== */
window.sendWA = function(name, price){
  const msg =
`Ø·Ù„Ø¨ Ù…Ù†ØªØ¬Ø§Øª â€“ Ø²ÙŠØªÙƒ
------------------
${name}
Ø§Ù„Ø³Ø¹Ø±: ${price} Ø¬Ù†ÙŠÙ‡`;

  window.open(
    `https://wa.me/${WHATSAPP}?text=${encodeURIComponent(msg)}`,
    "_blank"
  );
};

});
</script>

</body>
</html>
